#!python3
# -*- encoding: utf-8 -*-

import subprocess
import re
# import socket 

# my_ip = socket.gethostbyname(socket.gethostname())
ipRegex = r"((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)"
proc = subprocess.Popen(r'"C:\Program Files\Wireshark\tshark.exe" -i \Device\NPF_{07F78466-88E1-4DCF-B93B-F52F82330A86} -c 10000000',
                        shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT,
                        encoding="utf-8")

with open("capture.txt", "w", encoding="utf-8") as file:
    for line in iter(proc.stdout.readline, b""):
        ips = list(filter(
                   lambda x:x, 
                   [re.search(ipRegex, chunk).group(0) for chunk in line.split(" ")]
        ))
        if len(ips)>1:
            print(ips.join(" -> "))
        else:
            print(line)